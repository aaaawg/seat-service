<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <link th:href="@{/css/bootstrap.min.css}"
          href="../css/bootstrap.min.css" rel="stylesheet">
    <link th:href="@{/css/programList.css}" href="../css/programList.css" rel="stylesheet">
</head>
<body>
<div th:replace="/layout/nav.html :: nav"></div>
<br>
<div class="input-group searchDiv" style="margin-right: 20px">
    <input class="form-control h-25" type="text" placeholder="검색어 입력" id="enterKeyword">
    <button type="button" id="searchBtn" th:style="|background-image: url(@{/img/icon-search.png})|" onclick="search()"></button>
</div>
<div class="container" style="max-width: 1400px; clear: both">
    <th:block th:each="program: ${programs}" th:if="!${#dates.createToday().after(program.endDate)}">
        <div class="p-3 mx-1 my-2 bg-light text-dark rounded-3 row pDiv" style="width: 250px; height: 400px" th:onclick="|location.href='@{/program/{programNum}(programNum=${program.programNum})}'|">
            <div class="imgDiv">
                <img th:if="${program.filename != null}" th:src="@{'/files/' + ${program.filename}}" style="width: 100%; height: 300px">
                <div id="noImg" th:unless="${program.filename != null}">No Image</div>
                <span class="badge bg-secondary imgBadge">[[${program.type}]]</span>
                <div>
                    <span class="badge bg-secondary" th:if="${#dates.createToday().before(program.startDate)}">예정</span>
                    <span class="badge bg-secondary" th:if="${#dates.createToday().after(program.endDate)}">마감</span>
                    <span class="badge bg-secondary" th:if="${#dates.createToday().compareTo(program.startDate) >= 0} and ${program.endDate.compareTo(#dates.createToday()) >= 0}">진행</span>
                </div>
            </div>
            <div id="textDiv">
                <p th:text="${program.title}"></p>
                <p>[[${program.startDate}]] ~ [[${program.endDate}]] </p>
            </div>
        </div>
    </th:block>
</div>
<script>
    document.getElementById("enterKeyword").addEventListener("keydown", function (e) {
        if(e.key === "Enter") {
            search();
        }
    })

    function search() {
        let k = document.getElementById("enterKeyword").value;

        if(k.trim().length !== 0)
            location.href = '/program/search?keyword=' + k;
        else
            alert("검색어를 입력해주세요");
    }
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
</body>
</html>