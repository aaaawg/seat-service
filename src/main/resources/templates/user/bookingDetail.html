<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <link th:href="@{/css/bootstrap.min.css}"
        href="../css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div th:replace="/layout/nav.html :: nav"></div>
  <h2>세부 정보</h2>
  <div>
    <p>
      <span th:text="'예약번호 : ' + ${detail.bookingNum}"></span>
      <span th:text="'프로그램명 : ' + ${detail.programName}"></span>
      <span th:text="'유형 : ' + ${detail.type}"></span>
      <span th:text="'날짜 : ' + ${detail.viewingDate}"></span>
      <span th:text="'시간 : ' + ${detail.viewingTime}"></span>
      <span th:text="'장소 : ' + ${detail.place}"></span>
      <span th:if="${detail.seatNum != null}" th:text="'좌석 : ' + ${detail.seatNum}"></span>
      <button id="deleteProgram" th:attr="data-bookingNum=${detail.bookingNum}">신청취소</button>
    </p>
  </div>
  <script>
    document.getElementById('deleteProgram').addEventListener('click', function() {
    var jbResult = confirm('취소하시겠습니까?');
    if (jbResult) {
      var bookingNum = this.getAttribute('data-bookingNum');
      var url = '/myPage/' + bookingNum;  // 변경되어야 할 경로

      // 서버에 HTTP 요청 보내기
      var xhr = new XMLHttpRequest();
      xhr.open('POST', url);
      xhr.setRequestHeader('Content-Type', 'application/json');
      xhr.onreadystatechange = function() {
        if (xhr.readyState === 4 && xhr.status === 200) {
          alert('신청이 취소되었습니다.');
          location.replace('http://localhost:8080/myPage');
        }
      };
      xhr.send();
    }
  });
  </script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
</body>
</html>